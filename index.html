<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>MoonX</title>
  <style>  
    .corner-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      width: 40px;
      height: 40px;
      background-color: #4c4cff;
      color: white;
      border-radius: 50%;
      font-weight: bold;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .corner-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    :root {
      --bg-color: #f2f2f2;
      --text-color: #000000;
      --input-bg: #ffffff;
      --btn-bg: #dddddd;
      --btn-active: #4c4cff;
    }
    body.dark {
      --bg-color: #121212;
      --text-color: #ffffff;
      --input-bg: #1e1e1e;
      --btn-bg: #333333;
    }
    body {
      margin: 0;
      background: var(--bg-color);
      color: var(--text-color);
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    .logo {
      font-size: 60px;
      font-weight: bold;
      color: var(--btn-active);
      text-shadow: 0 0 10px #bfcfff;
      margin-bottom: 30px;
    }
    .uzum-services {
      display: flex;
      justify-content: center;
      gap: 50px;
      margin-top: 20px; /* –º–µ–∂–¥—É MoonX –∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ */
      margin-bottom: 40px; /* –æ—Ç—Å—Ç—É–ø –≤–Ω–∏–∑ –æ—Ç —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–æ –ø–æ–ª—è –ø–æ–∏—Å–∫–∞ */
      flex-wrap: wrap;
    }
    .uzum-services a {
      text-align: center;
      text-decoration: none;
      color: inherit;
    }
   .uzum-services img {
      width: 60px;
      height: 60px;
      border-radius: 20%;
    }
    .uzum-services div {
      margin-top: 8px;
      font-weight: 600;
      font-family: sans-serif;
    }
    .search-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .search-container {
      display: flex;
      justify-content: center;
      margin-top: 30px;
    }
    .search-box {
      position: relative;
      display: flex;
      align-items: center;
      width: 700px;
      border: 2px solid #ccc;
      border-radius: 28px;
      padding: 5px 10px;
      background-color: white;
    }
    #search-input {
      flex: 1;
      height: 42px;
      border: none;
      font-size: 16px;
      outline: none;
      padding-left: 16px;
      border-radius: 28px;
    }
    .search-icons {
      display: flex;
      gap: 10px;
      margin-left: 10px;
    }
    .icon-button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 6px;
      border-radius: 50%;
      transition: background 0.2s;
    }
    .icon-button:hover {
      background: #eee;
    }
    .engine-select.horizontal {
      flex-direction: row !important;
      justify-content: center;
      gap: 10px;
      margin-top: 10px;
   }
    .engine-select {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .engine-select button {
      padding: 8px 16px;
      border: none;
      border-radius: 10px;
      background: var(--btn-bg);
      cursor: pointer;
      color: var(--text-color);
    }
    .engine-select button.active {
      background: var(--btn-active);
      color: white;
    }
    .bookmarks {
      margin-top: 40px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .bookmarks button {
      padding: 8px 14px;
      border: none;
      border-radius: 10px;
      background: var(--btn-bg);
      color: var(--text-color);
      cursor: pointer;
    }
    .hidden { display: none; }
  </style>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É -->
  <div style="position: absolute; bottom: 20px; right: 20px; z-index: 1000;">
    <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
  </div>
  <!-- Google Sign-In –∫–Ω–æ–ø–∫–∞ -->
  <div id="google-signin-container" style="position:absolute; top:20px; right:120px; z-index:999;">
    <div id="g_id_onload"
         data-client_id="617555845778-kfgn7cnrc7sdc4stme1as1tfiu3bod8f.apps.googleusercontent.com"
         data-callback="handleCredentialResponse"
         data-auto_prompt="false">
    </div>
    <div class="g_id_signin"
         data-type="standard"
         data-size="medium"
         data-theme="outline"
         data-text="sign_in_with"
         data-shape="circle"
         data-logo_alignment="center">
    </div>
  </div>
  <!-- –ü—Ä–æ—Ñ–∏–ª—å Google -->
  <!-- Google OAuth -->
  <div id="google-profile" style="position:absolute; top:20px; right:20px; z-index:1000;"></div>
  
  <div class="corner-btn" onclick="location.reload()">M</div>

  <div class="logo">MoonX</div>

<!-- –ë–õ–û–ö uzum-—Å–µ—Ä–≤–∏—Å–æ–≤ -->
<div class="uzum-services">
  <a href="https://uzum.uz/ru/category/garantiya-nizkikh-cen--937?subCategoryId=10021" target="_blank">
    <img src="icons/uzum-market.png" alt="Uzum Market">
    <div>Uzum Market</div>
  </a>
  <a href="https://uzumbank.uz/ru/" target="_blank">
    <img src="icons/uzum-bank.png" alt="Uzum Bank">
    <div>Uzum Bank</div>
  </a>
  <a href="https://www.uzumtezkor.uz/ru" target="_blank">
    <img src="icons/uzum-tezkor.png" alt="Uzum Tezkor">
    <div>Uzum Tezkor</div>
  </a>
  <a href="https://webview.uzumavto.uz/uz" target="_blank">
    <img src="icons/uzum-avto.png" alt="Uzum Avto">
    <div>Uzum Avto</div>
  </a>
  <a href="https://uzumnasiya.uz/" target="_blank">
    <img src="icons/uzum-nasiya.png" alt="Uzum Nasiya">
    <div>Uzum Nasiya</div>
  </a>
</div>

<!-- Search Container with Voice and Camera Icons -->
<div class="search-container">
  <form id="search-form" class="search-box" target="_blank">
   <div id="engine-icon" style="cursor:pointer; margin-left:5px; display:flex; align-items:center;">
     <div id="engine-circle" style="width:30px; height:30px; border-radius:50%; background:#F8604A; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:bold; font-family:sans-serif;">
       –Ø
     </div>
   </div>
    <input type="text" id="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å..." />
    <div class="search-icons">
      <button type="button" class="icon-button" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫">
        <svg viewBox="0 0 32 32" width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M27.25 14.05ZM14.302 24.92c-5.19-.803-9.18-5.234-9.3-10.62h2a9 9 0 0 0 17.994 0h2c-.12 5.386-4.11 9.817-9.3 10.62l-.186.03-.482 3.85H14.97l-.482-3.85-.186-.03Z" fill="inherit"></path>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M10 9.05a6 6 0 0 1 12 0v5a6 6 0 0 1-12 0v-5Zm10 5v-5a4 4 0 0 0-8 0v5a4 4 0 1 0 8 0Z" fill="inherit"></path>
        </svg>
      </button>
      <button type="submit" class="icon-button" title="–ü–æ–∏—Å–∫">
        <svg viewBox="0 0 32 32" width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M27.25 14.05ZM14.302 24.92c-5.19-.803-9.18-5.234-9.3-10.62h2a9 9 0 0 0 17.994 0h2c-.12 5.386-4.11 9.817-9.3 10.62l-.186.03-.482 3.85H14.97l-.482-3.85-.186-.03Z" fill="inherit"></path>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M22.05 16.125a6.05 6.05 0 1 1-12.1 0 6.05 6.05 0 0 1 12.1 0ZM16 20.075a3.95 3.95 0 1 0 0-7.9 3.95 3.95 0 0 0 0 7.9Z" fill="inherit"></path>
        </svg>
      </button>
    </div>
  </form>
  <div id="engine-dropdown" style="display:none; position:absolute; top:52%; left:50%; transform:translate(-300px, 20px); background:white; border:1px solid #ccc; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.15); z-index:1000; padding:8px;">
    <div onclick="setEngine('yandex')" style="padding:6px 12px; cursor:pointer; display:flex; align-items:center;">
      <div style="width:24px; height:24px; border-radius:50%; background:#F8604A; color:#fff; font-weight:bold; display:flex; align-items:center; justify-content:center; margin-right:8px;">–Ø</div>
      –Ø–Ω–¥–µ–∫—Å
    </div>
    <div onclick="setEngine('google')" style="padding:6px 12px; cursor:pointer; display:flex; align-items:center;">
      <div style="width:24px; height:24px; border-radius:50%; background:#4285F4; color:#fff; font-weight:bold; display:flex; align-items:center; justify-content:center; margin-right:8px;">G</div>
      Google
    </div>
  </div>

  <div class="bookmarks" id="bookmarks"></div>

  <script>
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    let currentEngine = localStorage.getItem('engine') || 'yandex';
    const defaultBookmarks = [
      { name: 'YouTube', url: 'https://youtube.com' },
      { name: 'Wikipedia', url: 'https://ru.wikipedia.org' },
      { name: 'GitHub', url: 'https://github.com' },
      { name: 'ChatGPT', url: 'https://chat.openai.com' }
    ];

    function renderBookmarks() {
      const container = document.getElementById('bookmarks');
      container.innerHTML = '';
      defaultBookmarks.forEach(b => {
        const btn = document.createElement('button');
        btn.textContent = b.name;
        btn.onclick = () => window.open(b.url, '_blank');
        container.appendChild(btn);
      });
    }
    
    function setEngine(engine) {
      currentEngine = engine;
      localStorage.setItem('engine', engine);
      
      const icon = document.getElementById('engine-circle');
      if (engine === 'yandex') {
        icon.textContent = '–Ø';
        icon.style.background = '#F8604A';
      } else {
        icon.textContent = 'G';
        icon.style.background = '#4285F4';
      } 
        
      document.getElementById("engine-dropdown").style.display = "none";
    } 
           
    document.getElementById("engine-icon").addEventListener("click", function (e) {
      e.stopPropagation();
      const dropdown = document.getElementById("engine-dropdown");
      dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
    });
     
    window.addEventListener("click", function () {
      document.getElementById("engine-dropdown").style.display = "none";
    });
    
    window.addEventListener('DOMContentLoaded', () => {
      const saved = localStorage.getItem('engine') || 'yandex';
      setEngine(saved);
    });
    
    document.getElementById('search-form').addEventListener('submit', function (e) {
      e.preventDefault();
      const query = document.getElementById('search-input').value.trim();
      if (!query) return;
      let url = currentEngine === 'yandex'
        ? `https://yandex.ru/search/?text=${encodeURIComponent(query)}`
        : `https://www.google.com/search?q=${encodeURIComponent(query)}`;
      window.open(url, '_blank');
    });
   
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π JS –∫–æ–¥ -->
    function toggleTheme() {
      const darkMode = document.body.classList.toggle('dark');
      localStorage.setItem('theme', darkMode ? 'dark' : 'light');
      document.querySelector('.theme-toggle').textContent = darkMode ? '‚òÄÔ∏è' : 'üåô';
    }
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–π —Ç–µ–º—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    window.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        document.body.classList.add('dark');
        document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è';
      }
    });    

    function handleCredentialResponse(response) {
      const data = parseJwt(response.credential);
      localStorage.setItem("user_name", data.name);
      localStorage.setItem("user_email", data.email);
      localStorage.setItem("user_picture", data.picture);
      renderGoogleUser();
    }

    function parseJwt(token) {
      const base64 = token.split('.')[1].replace(/-/g, '+').replace(/_/g, '/');
      return JSON.parse(decodeURIComponent(atob(base64).split('').map(c =>
        '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join('')));
    }
    function renderGoogleUser() {
      const name = localStorage.getItem("user_name");
      const email = localStorage.getItem("user_email");
      const picture = localStorage.getItem("user_picture");
      if (!name || !email) return;
         
      // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—Ö–æ–¥–∞
      document.getElementById("google-signin-container")?.classList.add("hidden");
       
      const container = document.getElementById("google-profile");
      container.innerHTML = `
        <div style="position:relative;">
          <img id="avatar-btn" src="${picture}" alt="avatar"
               style="width:40px;height:40px;border-radius:50%;cursor:pointer;border:2px solid white;box-shadow:0 0 5px #000;" />
          <div id="profile-dropdown" class="hidden"
               style="position:absolute; top:50px; right:0; background:var(--input-bg); color:var(--text-color); padding:20px; border-radius:18px; box-shadow:0 2px 15px rgba(0,0,0,0.3); width:300px; text-align:center; font-family:sans-serif;">
            <div style="font-size:14px; color:gray; margin-bottom:10px;">${email}</div>
            <img src="${picture}" style="width:70px;height:70px;border-radius:50%;margin-bottom:10px;border:1px solid #ccc;" />
            <div style="font-weight:bold;font-size:16px;margin-bottom:5px;">${name}</div>

            <button onclick="window.open('https://myaccount.google.com/', '_blank')"
              style="margin:10px 0; padding:8px 12px; border:1px solid #888; border-radius:8px; background:transparent; cursor:pointer;">
              –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º Google
            </button>

            <hr style="margin:12px 0;">
            <div style="text-align:left; padding-left:10px;">
              <div style="margin-bottom:8px;"><strong>${name}</strong><br><small>${email}</small></div>
              <button onclick="window.open('https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fwww.google.com%3Fhl%3Dru&ec=GAlA8wE&hl=ru&flowName=GlifWebSignIn&flowEntry=AddSession', '_blank')"
                style="padding:6px 12px; background:#eee; border:none; border-radius:6px; cursor:pointer;">+ –î–æ–±–∞–≤–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
              <br><br>
              <button onclick="logoutGoogle()" style="color:red; background:none; border:none; cursor:pointer; font-weight:bold;">–í—ã–π—Ç–∏ –∏–∑ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤</button>
            </div>
          </div>
        </div>
      `;
      document.getElementById("avatar-btn").onclick = () => {
        document.getElementById("profile-dropdown").classList.toggle("hidden");
      };
    }
     document.getElementById("toggle-engine-btn").addEventListener("click", function () {
       const panel = document.getElementById("engine-select");
       panel.style.display = panel.style.display === "none" ? "flex" : "none";
     });
    function logoutGoogle() {
      localStorage.clear();
      location.reload();
    }
    renderBookmarks();
    updateEngineButtons();
    renderGoogleUser();
  </script>
</body>
</html>
